
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Complementaria 3: Cadenas de Markov en Python &#8212; Libro Modelos Probabilísticos - IIND 2104</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=406e030a" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/complementarias/Complementaria3';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Complementaria 4: Manejo de datos y análisis preliminar en Python" href="Complementaria4/Complementaria4.html" />
    <link rel="prev" title="Complementaria 2: Álgebra Lineal en Python" href="Complementaria2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/uniandes.png" class="logo__image only-light" alt="Libro Modelos Probabilísticos - IIND 2104 - Home"/>
    <img src="../../_static/uniandes.png" class="logo__image only-dark pst-js-only" alt="Libro Modelos Probabilísticos - IIND 2104 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecturas Semanales</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecturas_semanales/Modulo1.html"><span style="color:#86A8B3; font-weight: bold;">Módulo 1: Introducción (Semana 1)</span></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter0.html">Distribuciones de probabilidad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter1.html">Procesos estocásticos</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecturas_semanales/Modulo2.html"><span style="color:#86A8B3; font-weight: bold;">Módulo 2: De un sistema real a un modelo (Semanas 2-8)</span></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter2.html">Procesos de Poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter3.html">Cadenas de Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter4.html">Análisis transitorio de cadenas de Markov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter5.html">Clasificación de estados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter6.html">Probabilidades en estado estable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter7.html">Cadenas embebidas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter8.html">Análisis de tiempos promedios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter9.html">Cadenas absorbentes: Tiempos antes de la absorción y probabilidades de absorción</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecturas_semanales/Modulo3.html"><span style="color:#86A8B3; font-weight: bold;">Módulo 3: Medir el sistema a través del modelo (Semanas 9-12)</span></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter10.html">Ley de Little</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter11.html">Procesos de nacimiento y muerte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter12.html">Teoría de Colas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter13.html">Redes de Jackson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter14.html">Costos en cadenas de Markov</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecturas_semanales/Modulo4.html"><span style="color:#86A8B3; font-weight: bold;">Módulo 4: Toma de decisiones para mejorar el sistema (Semanas 13-16)</span></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter18.html">Procesos de Decisión Markovianos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter15.html">Procesos de decisión en el tiempo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter17.html">Programación Dinámica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecturas_semanales/archivos/chapter16.html">Principio de Optimalidad y Ecuaciones de Bellman</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Complementarias</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tutorial/tutorial.html"><h3 style="color: #ADD8E6;">Tutorial: Instalación Python y Visual Studio Code</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="AmbientesVirtuales/Ambientes_virtuales.html"><h3 style="color: #ADD8E6;">Ambientes Virtuales en Python</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria1.html"><h3 style="color: #ADD8E6;">Complementaria 1: Introducción a Python</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria2.html"><h3 style="color: #ADD8E6;">Complementaria 2: Álgebra Lineal en Python</h3></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><h3 style="color: #ADD8E6;">Complementaria 3: Cadenas de Markov en Python</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria4/Complementaria4.html"><h3 style="color: #ADD8E6;">Complementaria 4: Manejo de datos y análisis preliminar en Python</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria5/Complementaria5_IntroDash.html"><h3 style="color: #ADD8E6;">Complementaria 5: Introducción a Dash</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria6.html"><h3 style="color: #ADD8E6;">Complementaria 6: Análisis de tiempos promedio</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria7.html"><h3 style="color: #ADD8E6;">Complementaria 7: Cálculo de filas</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria8.html"><h3 style="color: #ADD8E6;">Complementaria 8: Simulación de Montecarlo</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria9.html"><h3 style="color: #ADD8E6;">Complementaria 9: MDP en Python</h3></a></li>
<li class="toctree-l1"><a class="reference internal" href="Complementaria10.html"><h3 style="color: #ADD8E6;">Complementaria 10: SDP en Python</h3></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/complementarias/Complementaria3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><h3 style="color: #ADD8E6;">Complementaria 3: Cadenas de Markov en Python</h3></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="complementaria-3-cadenas-de-markov-en-python">
<h1><h3 style="color: #ADD8E6;">Complementaria 3: Cadenas de Markov en Python</h3><a class="headerlink" href="#complementaria-3-cadenas-de-markov-en-python" title="Link to this heading">#</a></h1>
<h3 style="color: #ADD8E6;">Ejemplo 1. Cadena de Markov de Tiempo Discreto 
</h3><p>Retomando el problema de la complementaria 2 que considera la evolución del Índice de la Calidad del Aire (ICA) para el caso específico en que se consideran únicamente los días laborables. La situación fue modelada con una CMTD con la variable de estado y espacio de estados que se muestran a continuación.</p>
<div class="math notranslate nohighlight">
\[
I_n = \text{Nivel del ICA en el n-ésimo día}
\]</div>
<div class="math notranslate nohighlight">
\[
S_I = \{1, 2, 3, 4, 5\}
\]</div>
<p>Las probabilidades de transición en un paso entre estados de esta CMTD son las siguientes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P_{i \rightarrow j} = \begin{cases}
0.5 &amp; \text{si } j = i + 1, i &lt; 5 \\
0.3 &amp; \text{si } j = i, 1 &lt; i &lt; 5 \\
0.2 &amp; \text{si } j = i - 1, i &gt; 1 \\
0.5 &amp; \text{si } j = i = 1 \\
0.8 &amp; \text{si } j = i = 5 \\
0 &amp; \text{dlc}
\end{cases}
\end{split}\]</div>
<p>Ahora, se implementarán en Python estos componentes del modelo. Los detalles de la implementación ya fueron explicados en la complementaria 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">filas</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">columnas</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Crear una matriz de ceros de 5x5</span>
<span class="n">matriz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filas</span><span class="p">,</span> <span class="n">columnas</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>

<span class="c1"># Llenar la matriz con valores</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filas</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columnas</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">filas</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">filas</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="n">filas</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matriz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="nb">print</span><span class="p">(</span><span class="n">matriz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.5 0.5 0.  0.  0. ]
 [0.2 0.3 0.5 0.  0. ]
 [0.  0.2 0.3 0.5 0. ]
 [0.  0.  0.2 0.3 0.5]
 [0.  0.  0.  0.2 0.8]]
</pre></div>
</div>
</div>
</div>
<p>Para crear la cadena de markov utilizaremos la libreria <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code>, en este caso solo utilizaremos la instancia <code class="docutils literal notranslate"><span class="pre">dtmc</span></code> ya que estamos creando una cadena de markov de tiempo <strong>discreto</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jmarkov.dtmc</span> <span class="kn">import</span> <span class="n">dtmc</span>
</pre></div>
</div>
</div>
</div>
<p>Finalmente, utilizaremos la funcion <code class="docutils literal notranslate"><span class="pre">dtmc</span></code> que tiene como parametro la <code class="docutils literal notranslate"><span class="pre">matriz</span></code> que creamos anteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">dtmc</span><span class="p">(</span><span class="n">matriz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<h3 style="color: #ADD8E6;">Problema 1. Literal b.
</h3><p>En este caso se pide calcular la probabilidad de que en el día viernes el proceso estocástico esté en cualquiera de los estados que determinan el cierre de los colegios (es decir, estados 4 y 5), dado que hoy (lunes) está en el nivel 2. Esta probabilidad se puede obtener a partir de la distribución transitoria después de 4 transiciones, que se calcula como</p>
<div class="math notranslate nohighlight">
\[
\alpha \cdot P^4, 
\]</div>
<div class="math notranslate nohighlight">
\[
\alpha = \{0, 1, 0, 0, 0\}
\]</div>
<p>Para calcular en Python la distribución de probabilidad mencionada se utilizará el método <code class="docutils literal notranslate"><span class="pre">transient_probabilities</span></code> de la libreria <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code> que recibe como parametro el vector inicial <code class="docutils literal notranslate"><span class="pre">alpha</span></code> y el número de pasos necesarios <code class="docutils literal notranslate"><span class="pre">n</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_viernes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_viernes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.1144 0.1941 0.244  0.235  0.2125]
</pre></div>
</div>
</div>
</div>
<p>Para encontrar la probabilidad que se busca se suman los dos últimos componentes del vector <code class="docutils literal notranslate"><span class="pre">prob_viernes</span></code>, que corresponden a las probabilidades de que el proceso estocástico esté en el estado 4 o 5 después de 4 pasos (días) de evolución.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_cierre</span> <span class="o">=</span> <span class="n">prob_viernes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">prob_viernes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; La probabilidad de que el viernes los colegios suspendan la actividad académica debido a la mala calidad del aire, dado que hoy (lunes) el ICA se encuentra en el nivel 2, es: </span><span class="si">{</span><span class="n">prob_cierre</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> La probabilidad de que el viernes los colegios suspendan la actividad académica debido a la mala calidad del aire, dado que hoy (lunes) el ICA se encuentra en el nivel 2, es: 0.4475
</pre></div>
</div>
</div>
</div>
<h3 style="color: #ADD8E6;">Problema 1. Literal c.
</h3><p>El literal c pide proporcionar una expresión para el gasto promedio total en que incurrirá el distrito hasta el viernes, teniendo en cuenta que el distrito incurre en un gasto de 120 millones de COP por día cuando el ICA alcanza el nivel “Muy dañina para la salud”. Hoy es lunes, y el ICA está en nivel “Moderada”.</p>
<p>Nuevamente, en este es caso posible resolver la pregunta usando análisis transitorio del modelo. Es necesario calcular primero los vectores de distribución de probabilidad de estado, para cada día, dado que el día lunes el ICA se encuentra en el nivel 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">probs_martes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">probs_miercoles</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">probs_jueves</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">probs_viernes</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>A continuacion se calcula el gasto esperado para cada día, multiplicando el valor del gasto diario por el quinto componente de cada uno de los vectores de probabilidad previamente calculados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasto_diario</span> <span class="o">=</span> <span class="mi">120</span>

<span class="n">gasto_martes</span> <span class="o">=</span> <span class="n">gasto_diario</span> <span class="o">*</span> <span class="n">probs_martes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">gasto_miercoles</span> <span class="o">=</span> <span class="n">gasto_diario</span> <span class="o">*</span> <span class="n">probs_miercoles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">gasto_jueves</span> <span class="o">=</span> <span class="n">gasto_diario</span> <span class="o">*</span> <span class="n">probs_jueves</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">gasto_viernes</span> <span class="o">=</span> <span class="n">gasto_diario</span> <span class="o">*</span> <span class="n">probs_viernes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>El gasto promedio total está dado por la suma de los costos esperados de cada día.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gasto_total_esperado</span> <span class="o">=</span> <span class="n">gasto_martes</span> <span class="o">+</span> <span class="n">gasto_miercoles</span> <span class="o">+</span> <span class="n">gasto_jueves</span> <span class="o">+</span> <span class="n">gasto_viernes</span>
<span class="n">gasto_total_esperado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40.5
</pre></div>
</div>
</div>
</div>
<h3 style="color: #ADD8E6;">Ejemplo 2. Cadena de Markov de Tiempo Continuo 
</h3><p>Ahora, se resolverá el problema 2 que se encuentra en el archivo “Complementaria 3 (Q).pdf”. Sea <span class="math notranslate nohighlight">\(X(t)\)</span> el número de bicicletas alquiladas en el tiempo <span class="math notranslate nohighlight">\( t \)</span>, y sea <span class="math notranslate nohighlight">\(S_x = \{0, 1, 2, ..., 15\}\)</span>. Como <span class="math notranslate nohighlight">\(\{X(t), t &gt; 0\}\)</span> es una cadena de Markov en tiempo continuo (CMTC), se debe definir la matriz <strong>Q</strong>. Las tasas de transición entre estados de esta cadena son las siguientes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Q_{i \rightarrow j} = \begin{cases}
5 &amp; \text{si } j = i + 1, i &lt; 15 \\
9 \cdot i &amp; \text{si } j = i - 1, i &gt; 0 \\
0 &amp; \text{d.l.c}
\end{cases}
\end{split}\]</div>
<p>Ahora, se crea la matriz de tasas de transición, que llamaremos <code class="docutils literal notranslate"><span class="pre">matriz2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jmarkov.ctmc</span> <span class="kn">import</span> <span class="n">ctmc</span>

<span class="n">filas</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">columnas</span> <span class="o">=</span> <span class="mi">15</span>

<span class="c1"># Crear una matriz de ceros de 15x15</span>
<span class="n">matriz2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filas</span><span class="p">,</span> <span class="n">columnas</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>

<span class="c1"># Se llena la matriz con las respectivas tasas.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filas</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columnas</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">matriz2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matriz2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">i</span>

<span class="c1"># Se llena la diagonal con la suma negativa de las filas de la matriz.</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="c1"># Diagonal.</span>
    <span class="n">matriz2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">matriz2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">ctmc</span><span class="p">(</span><span class="n">matriz2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Para hacer estudios de análisis transitorio en CMTC, se debe calcular el vector de probabilidades <span class="math notranslate nohighlight">\( \pi(t) \)</span>. Para esto, se utiliza el exponencial de la matriz <span class="math notranslate nohighlight">\( Qt \)</span>. Recuerde que</p>
<div class="math notranslate nohighlight">
\[
\pi(t) = \pi(0)e^{Q \cdot t},
\]</div>
<p>donde <span class="math notranslate nohighlight">\( \pi(0)\)</span> es el vector de estado inicial de probabilidades y <span class="math notranslate nohighlight">\( t \)</span> es el instante de tiempo en el cual se desea calcular la distribución de probabilidad.</p>
<h3 style="color: #ADD8E6;">Problema 2. Literal b.
</h3><p>El literal b dice: el local ha programado una limpieza y mantenimiento preventivo a las bicicletas. Esta tarea  ha  sido  programada  para  el  próximo  lunes  a  las  12:00 pm y  será  realizada únicamente a las bicicletas que se encuentren en ese momento en el local. Suponga que el día de hoy (jueves) a las 12:00 pm, 10 bicicletas estaban alquiladas. Calcule el número promedio de bicicletas a las que se les realizará limpieza y mantenimiento el lunes.</p>
<p>Para solucionar este problema, se debe empezar calculando las probabilidades de tener alquiladas un determinado número de bicicletas el próximo lunes a las 12:00 pm, dado que hoy (jueves) a las 12:00 pm, 10 bicicletas están alquiladas.</p>
<p>A continuación se crea el vector de estado inicial de probabilidades, que tendrá por nombre <code class="docutils literal notranslate"><span class="pre">alpha2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear un array con 16 elementos, todos con valor de 0.</span>
<span class="n">alpha2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> 

<span class="c1"># Asignar un 1 en la posición 11 (Índice 10), Ya que corresponde a las 10 bicicletas prestadas en el momento t.</span>
<span class="n">alpha2</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">alpha2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>Con esto, es posible calcular el vector de probabilidades del próximo lunes a las 12:00 pm. Se sabe que, en este caso, el valor de t es igual a 96 y está expresado en horas. Para calcular la distribución de probabilidad se utilizará la funcion <code class="docutils literal notranslate"><span class="pre">transient_probabilities</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code> que recibe como parámetro el vector inicial <code class="docutils literal notranslate"><span class="pre">alpha</span></code> y el instante del tiempo (en horas) a considerar <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">96</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Como la variable de estado está expresada en términos del número de bicicletas alquiladas, si a 15 se le resta este número, entonces se obtendrá el número de bicicletas que están <strong>disponibles</strong> en el local. Esto se tiene en cuenta a continuación para encontrar el valor esperado de bicicletas a las que se les realizará limpieza y mantenimiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_bicis</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">))</span>
<span class="n">resultado</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">probs</span> <span class="o">*</span> <span class="n">num_bicis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;El número promedio de bicicletas a las que se les realizará limpieza y mantenimiento el lunes es, dado que actualmente hay 10 bicis alquiladas es: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">resultado</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El número promedio de bicicletas a las que se les realizará limpieza y mantenimiento el lunes es, dado que actualmente hay 10 bicis alquiladas es: 14.444
</pre></div>
</div>
</div>
</div>
<h3 style="color: #ADD8E6;">Comandos Útiles
</h3><p>A continuación se presentan algunos comandos de la librería <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code> que pueden ser de utilidad al momento de estudiar Cadenas de Markov de Tiempo Continuo o Cadenas de Markov de Tiempo Discreto:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Comando</p></th>
<th class="head text-center"><p>Operacion</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">is_ergodic</span></code></p></td>
<td class="text-center"><p>Retorna verdadero si la cadena es ergódica, falso en caso contrario.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">is_irreducible</span></code></p></td>
<td class="text-center"><p>Retorna verdadero si la cadena es irreducible, falso en caso contrario.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">first_passage_time</span></code></p></td>
<td class="text-center"><p>Calcula el tiempo promedio de primera llegada a un estado objetivo desde un estado inicial.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">occupation_time</span></code></p></td>
<td class="text-center"><p>Calcula el tiempo promedio que la cadena permanecerá en cada estado, considerando todos los estados iniciales posibles.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">period</span></code></p></td>
<td class="text-center"><p>Retorna el periodo de la cadena (en tiempo discreto).</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">steady_state</span></code></p></td>
<td class="text-center"><p>Calcula la distribución estacionaria de la cadena de Markov.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">transient_probabilities</span></code></p></td>
<td class="text-center"><p>Calcula la distribución transitoria en el instante n o t, dado el estado inicial alpha</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">n_states</span></code></p></td>
<td class="text-center"><p>Retorno el numero de estados de la cadena.</p></td>
</tr>
</tbody>
</table>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content\complementarias"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Complementaria2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><h3 style="color: #ADD8E6;">Complementaria 2: Álgebra Lineal en Python</h3></p>
      </div>
    </a>
    <a class="right-next"
       href="Complementaria4/Complementaria4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><h3 style="color: #ADD8E6;">Complementaria 4: Manejo de datos y análisis preliminar en Python</h3></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Equipo Modelos Probabilísticos
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>